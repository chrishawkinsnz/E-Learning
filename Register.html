<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Register Page</title>
</head>
<h1>Register</h1>
<style>
.error-message {
  color: red;
}
</style>
	<script type="text/javascript" src="js/libraries/angular/angular.js"></script>
	<script type="text/javascript" src="jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="js/app.js"></script>
	<script type="text/javascript" src="js/controllers.js"></script>
	<script type="text/javascript" src="js/services.js"></script>
<form novalidate ng-app name="login">

	<label for="fname">First Name</label>
	<input type="text" name="fname" ng-model="fname" ng-minlength="3" ng-maxlength="15" required />
	<br />

	<label for="lname">Last Name</label>
	<input type="text" name="lname" ng-model="lname" ng-minlength="3" ng-maxlength="15" required />
	<br />

  	<div class="error-message"
  		ng-show="login.username.$dirty && login.username.$error.required">
  		The username is required
  	</div>
	<div class="error-message" ng-show="login.username.$error.minlength">
		The username should be more than 2 symbols
	</div>
	<div class="error-message"
		ng-show="login.username.$error.maxlength">
		The username should not be more than 15 symbols
	</div>
	<label for="username">User</label>
	<input type="text" name="username" ng-model="username" ng-minlength="3" ng-maxlength="15" required />
	<br />

	<div class="error-message"
		ng-show="login.email.$invalid">The email is not valid
	</div>
	<label for="email">Email</label>
	<input type="email" name="email" ng-model="email" />
	<br />

	<div class="error-message"
		ng-show="login.password.$dirty && login.password.$error.required">
		The password is required
	</div>
	<div class="error-message" ng-show="login.password.$error.pattern">
		The password should containing at least 8 characters, 1 number, 1 upper and 1 lowercase
	</div>
	<label for="password">Password</label>
	<input type="password" name="password" ng-model="password" required
	ng-pattern="/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{8,}$/" />

	<br>
	<input type="button" id="submit" value="Submit">
	<input type="button" id="home" value="Home">
	<script type="text/javascript">
    document.getElementById("submit").onclick = confirm;

    function confirm() {
    	console.log("username: "+ login.username.value);
    	console.log("email: "+ login.email.value);
    	console.log("password : "+ login.password.value);
    	console.log("fname: "+ login.fname.value);
    	console.log("lname: "+ login.lname.value);

    	//if any fields are blank get outa here
    	if(!login.username.value){
    		alert("please enter a username");
    		return;
    	}
    	if(!login.email.value){
    		alert("please enter a email");
    		return;
    	if(!login.password.value){
    		alert("please enter a password");
    		return;
    	if(!login.fname.value){
    		alert("please enter a first name");
    		return;
    	if(!login.lname.value){
    		alert("please enter a last name");
    		return;
    	}
		    //alert("Successful");
		    //call PHP function
		$.ajax({
			url:'http://shrouded-earth-7234.herokuapp.com/processRegister.php',
			type: 'post',
			data: {"funcName":"register","username":login.username.value,"email":login.email.value,"password":login.password.value,"fname":login.fname.value,"lname":login.lname.value},

			success: function(response){
				console.log(response);

			if(response.indexOf("success")==-1){
				alert("Could not register!");
			}
			else{
				alert("Registration Successful");
				sessionStorage.setItem('username',login.username.value);
				sessionStorage.setItem('password',login.password.value);
 				window.location = "http://shrouded-earth-7234.herokuapp.com/quizTest.html";
			}
			}
		});

    }



	document.getElementById("home").onclick = linkToHome;
	   	function linkToHome() {
	   		window.location = "http://shrouded-earth-7234.herokuapp.com/login-fancy.html";
	}
</script>
</form>
</html>
